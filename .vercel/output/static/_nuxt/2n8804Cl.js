import{u as f}from"./BpQPQGIj.js";import{f as r}from"./DB7M4-of.js";const v=/^[^\s@]+@[^\s@]+\.[^\s@]{2,}$/;function d(){const t=r(""),i=r(""),s=r(!1),e=r(""),a=r(!1);async function n(){if(s.value)return;if(i.value){a.value=!0,e.value="Revisa el teu correu per confirmar la subscripció.";return}const u=t.value.trim().toLowerCase();if(!u){a.value=!1,e.value="Introdueix una adreça de correu electrònic.";return}if(!v.test(u)){a.value=!1,e.value="Introdueix una adreça de correu electrònic vàlida.";return}s.value=!0,e.value="";const l=f(),o=new Date(Date.now()+1440*60*1e3).toISOString(),{error:c}=await l.from("newsletter_subscribers").insert({email:u,confirmation_expires_at:o,is_confirmed:!1});c?(a.value=!0,e.value="Si aquest correu ja està registrat, revisa la teva safata d’entrada."):(a.value=!0,e.value="Revisa el teu correu per confirmar la subscripció.",t.value=""),s.value=!1}return{email:t,honeypot:i,isSubmitting:s,message:e,success:a,subscribe:n}}export{d as u};
